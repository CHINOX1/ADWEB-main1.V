{% extends "central.html" %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-xl-10">
            <div class="card">
                <div class="card-header bg-primary text-white py-3">
                    <h2 class="h5 mb-0">
                        <i class="bi bi-person-badge me-2"></i>
                        Nuevo Uusario
                    </h2>
                </div>

                <div class="card-body p-4">
                    <form method="post" class="needs-validation" novalidate>
                        {% csrf_token %}
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    {{ form.username }}
                                    <label>Nombre de usuario</label>
                                    <div class="invalid-feedback">
                                        {{ form.username.errors|first }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    {{ form.empresa }}
                                    <label>Empresa</label>
                                    <div class="invalid-feedback">
                                        {{ form.empresa.errors|first }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <div class="form-floating">
                                    {{ form.rut }}
                                    <label>RUT</label>
                                    <div class="invalid-feedback">
                                        {{ form.rut.errors|first }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-floating">
                                    {{ form.nombre }}
                                    <label>Nombre</label>
                                    <div class="invalid-feedback">
                                        {{ form.nombre.errors|first }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-floating">
                                    {{ form.last_name }}
                                    <label>Apellido Paterno</label>
                                    <div class="invalid-feedback">
                                        {{ form.last_name.errors|first }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    {{ form.email }}
                                    <label>Email</label>
                                    <div class="invalid-feedback">
                                        {{ form.email.errors|first }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    {{ form.celular }}
                                    <label>Celular</label>
                                    <div class="invalid-feedback">
                                        {{ form.celular.errors|first }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-5">
                            <label class="form-label fw-bold">Permisos</label>
                            <div class="border rounded-3 p-3">
                                {{ form.permisos }}
                            </div>
                        </div>

                        <div class="d-flex justify-content-between border-top pt-4">
                            <a href="{% url 'configuracion_home' %}" class="btn btn-secondary">
                                <i class="bi bi-arrow-left me-2"></i>Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save me-2"></i>Guardar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .dual-listbox {
        display: flex;
        flex-direction: column;
    }
    
    .dual-listbox .dual-listbox__container {
        flex-direction: row;
        gap: 1rem;
    }
    
    .dual-listbox__available,
    .dual-listbox__selected {
        flex: 1;
        min-width: 300px;
    }
</style>

<script>
    $(document).ready(function() {
        $('#id_permisos').bootstrapDualListbox({
            nonSelectedListLabel: 'Permisos Disponibles',
            selectedListLabel: 'Permisos Asignados',
            preserveSelectionOnMove: 'moved',
            moveOnSelect: false,
            infoText: 'Mostrando {0} elementos',
            infoTextFiltered: '<span class="badge bg-warning">Filtrado</span> {0} de {1}',
            filterPlaceHolder: 'Buscar...',
            filterTextClear: 'Limpiar',
            moveAllLabel: 'Mover todos',
            removeAllLabel: 'Quitar todos',
            selectorMinimalHeight: 300
        });
    });
</script>
{% endblock %}